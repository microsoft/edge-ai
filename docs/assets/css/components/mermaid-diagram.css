/**
 * Mermaid Diagram Component Styles
 * Comprehensive styling for Mermaid diagrams with SVG override support
 * Extracted from index-page.css for better organization and maintainability
 *
 * NOTE: Most !important declarations are required to override Mermaid's
 * inline SVG styles which cannot be overridden through normal CSS specificity
 */

/* Main mermaid diagram container */
.mermaid-diagram {
  background: var(--surface-white);
  border: 1px solid var(--gray-extended-200);
  border-radius: var(--spacing-xxs);
  padding: var(--spacing-md);
  margin: var(--spacing-lg) 0;
  box-shadow: 0 1px 2px var(--color-alpha-black-5);
  overflow-x: auto;
  overflow-y: visible;
  position: relative;
  width: 100%;
  max-width: none;
  min-width: 100%;
}

/* Compact layout override */
.mermaid-diagram {
  margin: var(--spacing-sm) 0;
  max-width: 100%;
  overflow-x: auto;
  overflow-y: visible;
}

.mermaid-diagram::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--theme-color), var(--theme-color-secondary));
  border-radius: var(--spacing-xxs) var(--spacing-xxs) 0 0;
}

/* Mermaid SVG styling - Better sizing and readability */
.mermaid-diagram svg {
  max-width: 100% !important;
  width: 100% !important;
  height: auto !important;
  min-height: auto;
  min-width: auto;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-size: 14px !important;
  background: transparent;
  display: block;
  margin: 0 auto;
  padding: 20px;
  overflow: visible;
}

/* Ultra-compact pie charts */
.mermaid-pie-chart {
  max-width: var(--spacing-layout-xxs-plus) !important;
  margin: var(--spacing-sm) auto !important;
  padding: var(--spacing-xs) !important;
  text-align: center;
}

.mermaid-pie-chart svg {
  max-width: var(--spacing-layout-xxxs) !important;
  width: var(--spacing-layout-xxxs) !important;
  height: var(--spacing-layout-xxxs) !important;
  margin: 0 auto !important;
  display: block !important;
  padding: 0 !important;
  min-height: auto !important;
}

/* Simplified text styling for better readability */
.mermaid-diagram svg text {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-size: 14px !important;
  fill: var(--color-gray-700);
  line-height: 1.3 !important;
}

/* Simplified text wrapping for node labels */
.mermaid-diagram .nodeLabel {
  font-size: 14px !important;
  font-weight: 500;
  line-height: 1.3 !important;
  padding: 4px 10px !important;
}

/* Fix node sizing to accommodate wrapped text */
.mermaid-diagram .node rect,
.mermaid-diagram .node circle,
.mermaid-diagram .node ellipse,
.mermaid-diagram .node polygon {
  stroke-width: 1px;
  filter: drop-shadow(0 0.5px 1px var(--color-alpha-black-10));
}

/* Ensure label containers have proper height */
.mermaid-diagram .label-container {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 4px 10px !important;
}

/* Fix foreignObject elements that contain the labels */
.mermaid-diagram foreignObject {
  overflow: visible !important;
  height: auto !important;
}

/* Ensure div inside foreignObject has proper spacing */
.mermaid-diagram foreignObject > div {
  padding: 4px 10px !important;
  line-height: 1.3 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  overflow: visible !important;
}

/* Tighter subgraph styling */
.mermaid-diagram .cluster rect {
  fill: var(--gray-extended-50) !important;
  stroke: var(--gray-extended-200) !important;
  stroke-width: 1px !important;
  rx: var(--spacing-xxs) !important;
  ry: var(--spacing-xxs) !important;
}

/* Subgraph styling improvements - override for better contrast */
.mermaid-diagram .cluster rect {
  fill: var(--gray-extended-50) !important;
  stroke: var(--gray-extended-200) !important;
  stroke-width: 1px !important;
  rx: var(--spacing-md) !important;
  ry: var(--spacing-md) !important;
}

/* Responsive design - desktop focused */
@media (max-width: 768px) {
  .mermaid-diagram {
    padding: var(--spacing-xxs);
    margin: var(--spacing-xs-plus) 0;
  }

  .mermaid-diagram svg {
    min-height: var(--spacing-layout-xs);
    max-height: var(--spacing-layout-xs);
    font-size: var(--spacing-xs-plus);
  }

  .mermaid-pie-chart {
    max-width: 95% !important;
  }

  .mermaid-pie-chart svg {
    width: 100% !important;
    height: auto !important;
    max-width: var(--layout-sidebar-width) !important;
    max-height: var(--spacing-layout-xxxs) !important;
  }
}

/* Remove excessive hover effects for compact display */
.mermaid-diagram .node:hover rect,
.mermaid-diagram .node:hover circle,
.mermaid-diagram .node:hover ellipse,
.mermaid-diagram .node:hover polygon {
  filter: drop-shadow(0 1px 2px var(--color-alpha-black-15));
  transition: all 0.1s ease;
}

.mermaid-diagram .node:hover text {
  font-weight: 700 !important; /* Override inline SVG styling */
}

/* ========================================
   CATEGORY-BASED STYLING
   Required !important to override inline SVG styles
   ======================================== */

/* Simplified capability group styling */
.mermaid-diagram .capabilityGroup {
  fill: var(--surface-slate-50) !important;
  stroke: var(--theme-color) !important;
  stroke-width: 2px !important;
  stroke-dasharray: 5,5 !important;
}

.mermaid-diagram .capabilityGroup text {
  fill: var(--theme-color) !important;
  font-weight: 700 !important;
  font-size: var(--spacing-md) !important;
}

/* Simplified color scheme for diagram categories */
.mermaid-diagram .categoryPoC {
  fill: var(--color-blue-50) !important;
  stroke: var(--color-blue-700) !important;
  stroke-width: 2px !important;
}

.mermaid-diagram .categoryPoC text {
  fill: var(--color-blue-800) !important;
}

.mermaid-diagram .categoryPoV {
  fill: var(--color-amber-100) !important;
  stroke: var(--color-amber-600) !important;
  stroke-width: 2px !important;
}

.mermaid-diagram .categoryPoV text {
  fill: var(--color-amber-800) !important;
}

.mermaid-diagram .categoryProd {
  fill: var(--color-green-50) !important;
  stroke: var(--color-green-600) !important;
  stroke-width: 2px !important;
}

.mermaid-diagram .categoryProd text {
  fill: var(--color-green-800) !important;
}

.mermaid-diagram .categoryScale {
  fill: var(--color-purple-50) !important;
  stroke: var(--color-purple-600) !important;
  stroke-width: 2px !important;
}

.mermaid-diagram .categoryScale text {
  fill: var(--color-purple-800) !important;
}

/* ========================================
   STATUS-BASED STYLING
   Required !important to override inline SVG styles
   ======================================== */

/* Simplified main node styling */
.mermaid-diagram .main {
  fill: var(--theme-color) !important;
  stroke: var(--theme-color-secondary) !important;
  stroke-width: 2px !important;
}

.mermaid-diagram .main text {
  fill: white !important;
}

/* Status-based styling with improved contrast */
.mermaid-diagram .available {
  fill: var(--surface-green-50) !important;
  stroke: var(--color-green-600) !important;
  stroke-width: 2px !important;
}

.mermaid-diagram .available text {
  fill: var(--color-green-800) !important;
  font-weight: 600 !important;
}

.mermaid-diagram .inDevelopment {
  fill: var(--surface-blue-50) !important;
  stroke: var(--color-blue-600) !important;
  stroke-width: 2px !important;
}

.mermaid-diagram .inDevelopment text {
  fill: var(--color-blue-800) !important;
  font-weight: 600 !important;
}

.mermaid-diagram .planned {
  fill: var(--color-indigo-100) !important;
  stroke: var(--color-indigo-500) !important;
  stroke-width: 2px !important;
}

.mermaid-diagram .planned text {
  fill: var(--color-indigo-700) !important;
  font-weight: 600 !important;
}

.mermaid-diagram .external {
  fill: var(--surface-purple-50) !important;
  stroke: var(--color-purple-500) !important;
  stroke-width: 2px !important;
}

.mermaid-diagram .external text {
  fill: var(--color-purple-600) !important;
  font-weight: 600 !important;
}

/* ========================================
   EDGE AND ARROW STYLING
   Required !important to override inline SVG styles
   ======================================== */

/* Enhanced edge/arrow styling */
.mermaid-diagram .edge-path {
  stroke: var(--gray-extended-500) !important;
  stroke-width: 2px !important;
  fill: none !important;
}

.mermaid-diagram .arrowheadPath {
  fill: var(--gray-extended-500) !important;
  stroke: var(--gray-extended-500) !important;
}

/* Error display for failed mermaid diagrams */
.mermaid-error {
  background: linear-gradient(135deg, #fee 0%, #fcc 100%);
  border: 2px solid #dc3545;
  border-radius: 8px;
  padding: 20px;
  margin: 20px 0;
  color: #721c24;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  box-shadow: 0 4px 12px rgba(220, 53, 69, 0.15);
}

/* Error details styling */
.mermaid-error details {
  margin-top: 10px;
}

.mermaid-error pre {
  margin: 5px 0;
  font-size: 12px;
}
