/* Table Component - Centralized, Accessible Table Styling */
/* =================================================================== */
/* This component provides comprehensive table styling with:
 * - WCAG 2.1 AA accessibility compliance
 * - Design token integration for consistency
 * - Dark mode support
 * - Responsive behavior
 * - Performance optimization for large datasets
 */

/* === DESIGN TOKEN FOUNDATION === */
:root {
  /* Table-specific semantic tokens derived from design system */
  --table-cell-padding: var(--spacing-md, 12px);
  --table-cell-padding-compact: var(--spacing-sm, 8px);
  --table-row-height: var(--size-xxl, 48px);
  --table-row-height-compact: var(--size-lg, 32px);
  --table-border-radius: var(--border-radius, 8px);
  --table-font-size: var(--font-size-sm, 14px);
  --table-font-size-compact: var(--font-size-xs, 12px);
  --table-line-height: var(--line-height-base, 1.4);

  /* Enhanced accessibility-compliant color tokens with elegant contrast ratios */
  /* Light theme: Refined contrast for elegant readability */
  --table-text-primary: var(--color-slate-800, #1e293b);
  --table-text-secondary: var(--color-slate-600, #475569);
  --table-text-muted: var(--color-slate-500, #64748b);
  --table-background-primary: var(--surface-white, #ffffff);
  --table-background-secondary: var(--surface-slate-50, #f8fafc);
  --table-background-hover: var(--surface-slate-100, #f1f5f9);
  --table-background-selected: var(--color-blue-alpha-10, rgba(59, 130, 246, 0.1));
  --table-border-primary: var(--color-slate-300, #cbd5e1);
  --table-border-secondary: var(--color-slate-400, #94a3b8);
  --table-header-background: var(--color-slate-100, #f1f5f9);
  --table-header-text: var(--color-slate-700, #334155);

  /* Interactive states with high contrast */
  --table-link-color: var(--theme-color, #0078d4);
  --table-link-hover: var(--theme-color-dark, #106ebe);
  --table-focus-outline: var(--theme-color, #0078d4);
  --table-focus-outline-width: 2px;
  --table-focus-outline-offset: 2px;
}

/* === DARK MODE TOKENS === */
body.dark {
  /* Dark theme: Enhanced contrast for better visibility */
  --table-text-primary: var(--color-slate-50, #f8fafc);
  --table-text-secondary: var(--color-slate-200, #e2e8f0);
  --table-text-muted: var(--color-slate-300, #cbd5e1);
  --table-background-primary: var(--color-slate-900, #0f172a);
  --table-background-secondary: var(--color-slate-800, #1e293b);
  --table-background-hover: var(--color-slate-700, #334155);
  --table-background-selected: var(--color-blue-alpha-20, rgba(59, 130, 246, 0.2));
  --table-border-primary: var(--color-slate-600, #475569);
  --table-border-secondary: var(--color-slate-500, #64748b);
  --table-header-background: var(--color-slate-800, #1e293b);
  --table-header-text: var(--color-slate-100, #f1f5f9);

  /* Enhanced contrast for dark mode interactivity */
  --table-link-color: var(--theme-color-light, #40a9ff);
  --table-link-hover: var(--theme-color, #0078d4);
  --table-focus-outline: var(--theme-color-light, #40a9ff);
}

/* === BASE TABLE STRUCTURE === */
.table,
table {
  width: 100%;
  border-collapse: collapse;
  border-spacing: 0;
  font-family: var(--font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);
  font-size: var(--table-font-size);
  line-height: var(--table-line-height);
  color: var(--table-text-primary);
  background-color: var(--table-background-primary);
  border-radius: var(--table-border-radius);
  overflow: hidden;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05), 0 1px 1px rgba(0, 0, 0, 0.04);
  border: 1px solid var(--table-border-primary);

  /* Performance optimization for large tables */
  table-layout: auto;
  contain: layout style;
}

/* Auto-fit tables to content width within markdown sections */
.markdown-section table {
  width: auto !important;
  max-width: 100%;
  min-width: 300px;
  margin-left: auto;
  margin-right: auto;
  display: table !important;
  table-layout: auto !important;
}

/* === TABLE SECTIONS === */
.table thead,
table thead {
  background-color: var(--table-header-background);
  color: var(--table-header-text);
  border-bottom: 2px solid var(--table-border-primary);
}

.table tbody,
table tbody {
  background-color: var(--table-background-primary);
}

.table tfoot,
table tfoot {
  background-color: var(--table-header-background);
  color: var(--table-header-text);
  border-top: 2px solid var(--table-border-secondary);
  font-weight: var(--font-weight-medium, 500);
}

/* === TABLE ROWS === */
.table tr,
table tr {
  border-bottom: 1px solid var(--table-border-primary);
  min-height: var(--table-row-height);
}

.table tbody tr:last-child,
table tbody tr:last-child {
  border-bottom: none;
}

/* === TABLE CELLS === */
.table th,
.table td,
table th,
table td {
  padding: var(--table-cell-padding);
  text-align: left;
  vertical-align: top;
  border-right: 1px solid var(--table-border-primary);
}

.table th:last-child,
.table td:last-child,
table th:last-child,
table td:last-child {
  border-right: none;
}

/* === HEADER CELLS === */
.table th,
table th {
  font-weight: var(--font-weight-medium, 500);
  font-size: var(--font-size-xs, 12px);
  position: relative;
  background-color: var(--table-header-background);
  color: var(--table-header-text);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

/* Header cell focus for accessibility */
.table th:focus,
table th:focus {
  outline: var(--table-focus-outline-width) solid var(--table-focus-outline);
  outline-offset: var(--table-focus-outline-offset);
  position: relative;
  z-index: 1;
}

/* === DATA CELLS === */
.table td,
table td {
  color: var(--table-text-primary);
  line-height: var(--table-line-height);
  font-weight: var(--font-weight-normal, 400);
}

/* Cell focus for accessibility */
.table td:focus,
table td:focus {
  outline: var(--table-focus-outline-width) solid var(--table-focus-outline);
  outline-offset: var(--table-focus-outline-offset);
  position: relative;
  z-index: 1;
}

/* === INTERACTIVE ELEMENTS === */
/* Links within tables */
.table a,
table a {
  color: var(--table-link-color);
  text-decoration: underline;
  transition: color var(--transition-fast, 0.15s) ease;
}

.table a:hover,
.table a:focus,
table a:hover,
table a:focus {
  color: var(--table-link-hover);
  text-decoration: none;
}

.table a:focus,
table a:focus {
  outline: var(--table-focus-outline-width) solid var(--table-focus-outline);
  outline-offset: var(--table-focus-outline-offset);
  border-radius: var(--border-radius-sm, 4px);
}

/* === TABLE VARIANTS === */

/* Striped tables for improved readability */
.table-striped tbody tr:nth-child(even),
table.table-striped tbody tr:nth-child(even) {
  background-color: var(--table-background-secondary);
}

/* Bordered tables */
.table-bordered,
table.table-bordered {
  border: 1px solid var(--table-border-secondary);
}

.table-bordered th,
.table-bordered td,
table.table-bordered th,
table.table-bordered td {
  border: 1px solid var(--table-border-primary);
}

/* Compact tables for space efficiency */
.table-compact,
table.table-compact {
  font-size: var(--table-font-size-compact);
}

.table-compact th,
.table-compact td,
table.table-compact th,
table.table-compact td {
  padding: var(--table-cell-padding-compact);
  min-height: var(--table-row-height-compact);
}

/* Large text tables for accessibility */
.table-large,
table.table-large {
  font-size: var(--font-size-base, 16px);
}

.table-large th,
.table-large td,
table.table-large th,
table.table-large td {
  padding: var(--spacing-lg, 16px);
  min-height: var(--size-xxxl, 56px);
}

/* === RESPONSIVE BEHAVIOR === */
.table-responsive {
  overflow-x: auto;
  border-radius: var(--table-border-radius);
}

/* Mobile-specific responsive handling */
@media (max-width: 768px) {
  .table-responsive {
    font-size: var(--table-font-size-compact);
  }

  .table-responsive th,
  .table-responsive td {
    padding: var(--table-cell-padding-compact);
    white-space: nowrap;
  }

  /* Stack table for very small screens if needed */
  .table-mobile-stack th,
  .table-mobile-stack td {
    display: block;
    width: 100%;
    border-right: none;
    border-bottom: 1px solid var(--table-border-primary);
  }

  .table-mobile-stack thead {
    display: none;
  }

  .table-mobile-stack tbody tr {
    display: block;
    margin-bottom: var(--spacing-md, 12px);
    border: 1px solid var(--table-border-primary);
    border-radius: var(--table-border-radius);
    background-color: var(--table-background-primary);
  }
}

/* === ACCESSIBILITY ENHANCEMENTS === */

/* Screen reader only captions */
.table-caption-sr-only,
table caption.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Visible captions */
.table caption,
table caption {
  caption-side: top;
  padding: var(--table-cell-padding);
  color: var(--table-text-secondary);
  font-weight: var(--font-weight-medium, 500);
  font-size: var(--font-size-base, 16px);
  text-align: left;
}

/* Enhanced focus indicators for keyboard navigation */
.table:focus-within,
table:focus-within {
  box-shadow: 0 0 0 var(--table-focus-outline-width) var(--table-focus-outline);
  border-radius: var(--table-border-radius);
}

/* === SORTABLE TABLE HEADERS === */
.table th[role="columnheader"][aria-sort],
table th[role="columnheader"][aria-sort] {
  cursor: pointer;
  -webkit-user-select: none;
  user-select: none;
  position: relative;
  padding-right: calc(var(--table-cell-padding) + 20px);
}

.table th[role="columnheader"][aria-sort]:focus,
table th[role="columnheader"][aria-sort]:focus {
  background-color: var(--table-background-hover);
}

/* Sort indicators */
.table th[role="columnheader"][aria-sort="ascending"]::after,
table th[role="columnheader"][aria-sort="ascending"]::after {
  content: "↑";
  position: absolute;
  right: var(--table-cell-padding);
  top: 50%;
  transform: translateY(-50%);
  color: var(--table-link-color);
  font-weight: bold;
}

.table th[role="columnheader"][aria-sort="descending"]::after,
table th[role="columnheader"][aria-sort="descending"]::after {
  content: "↓";
  position: absolute;
  right: var(--table-cell-padding);
  top: 50%;
  transform: translateY(-50%);
  color: var(--table-link-color);
  font-weight: bold;
}

.table th[role="columnheader"][aria-sort="none"]::after,
table th[role="columnheader"][aria-sort="none"]::after {
  content: "↕";
  position: absolute;
  right: var(--table-cell-padding);
  top: 50%;
  transform: translateY(-50%);
  color: var(--table-text-muted);
  opacity: 0.5;
}

/* === SELECTION SUPPORT === */
.table tr[aria-selected="true"],
table tr[aria-selected="true"] {
  background-color: var(--table-background-selected);
}

/* === EMPTY STATE === */
.table tbody:empty::after,
table tbody:empty::after {
  content: "No data available";
  display: table-cell;
  text-align: center;
  padding: calc(var(--table-cell-padding) * 2);
  color: var(--table-text-muted);
  font-style: italic;
}

/* === HIGH CONTRAST MODE SUPPORT === */
@media (prefers-contrast: high) {
  .table,
  table {
    border: 2px solid var(--table-border-secondary);
  }

  .table th,
  .table td,
  table th,
  table td {
    border: 1px solid var(--table-border-secondary);
  }
}

/* === REDUCED MOTION SUPPORT === */
@media (prefers-reduced-motion: reduce) {
  .table a,
  table a {
    transition: none;
  }
}

/* === PERFORMANCE OPTIMIZATIONS === */
/* Enable hardware acceleration for large tables */
.table-performance,
table.table-performance {
  transform: translate3d(0, 0, 0);
  will-change: scroll-position;
}

/* Virtual scrolling container support */
.table-virtual-container {
  height: 400px;
  overflow-y: auto;
  overflow-x: auto;
  border-radius: var(--table-border-radius);
}

.table-virtual-container .table,
.table-virtual-container table {
  border-radius: 0;
}

/* === PRINT STYLES === */
@media print {
  .table,
  table {
    border-collapse: collapse;
    border: 1px solid #000;
    page-break-inside: avoid;
  }

  .table th,
  .table td,
  table th,
  table td {
    border: 1px solid #000;
    padding: 8px;
  }

  .table tbody tr,
  table tbody tr {
    page-break-inside: avoid;
  }
}
