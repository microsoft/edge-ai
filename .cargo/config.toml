[registries.crates-io]
protocol = "sparse"

[registries]
aio-sdks = { index = "sparse+https://pkgs.dev.azure.com/azure-iot-sdks/iot-operations/_packaging/preview/Cargo/index/" }

# NOTE: We don't use "replace-with" for crates-io to maintain dual-registry support:
# - Local/GitHub builds: Use crates.io for public dependencies, skip Azure IoT packages
# - Azure DevOps builds: Access both crates.io and aio-sdks registry
#
# Dependencies explicitly opt-in to aio-sdks with registry = "aio-sdks" in Cargo.toml.
# Builds without aio-sdks access will fail when azure_iot_operations_* packages are required,
# but this is intentional - those packages are only available in Azure DevOps environments.
#
# Warning CFS0042 ("Missing replace-with key") can be safely ignored - it's a false positive
# for multi-registry configurations where some registries are environment-specific.

# All Azure IoT Operations packages should explicitly specify registry = "aio-sdks" in their
# Cargo.toml dependencies to use the Azure DevOps registry.
# Example:
# [dependencies]
# azure_iot_operations_mqtt = { version = "0.9.0", registry = "aio-sdks" }
