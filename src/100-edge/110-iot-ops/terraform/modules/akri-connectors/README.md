<!-- BEGIN_TF_DOCS -->
# Akri Connectors Module

Deploys multiple Azure IoT Operations Akri Connector Templates as part of
the IoT Operations deployment. Supports REST/HTTP, Media, ONVIF, and SSE
connector types with configurable runtime and MQTT settings.

## Requirements

| Name      | Version         |
|-----------|-----------------|
| terraform | >= 1.9.8, < 2.0 |
| azapi     | >= 2.0          |
| azurerm   | >= 4.0          |

## Providers

| Name  | Version |
|-------|---------|
| azapi | >= 2.0  |

## Resources

| Name                                                                                                                    | Type     |
|-------------------------------------------------------------------------------------------------------------------------|----------|
| [azapi_resource.connector_template](https://registry.terraform.io/providers/Azure/azapi/latest/docs/resources/resource) | resource |

## Inputs

| Name                 | Description                                                                                                                                                                  | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Default | Required |
|----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------|:--------:|
| aio\_instance\_id    | Azure IoT Operations instance ID where connector templates will be deployed.                                                                                                 | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | n/a     |   yes    |
| connector\_templates | List of Akri connector templates to deploy. Each connector must have a unique name and valid type. For custom types, provide custom\_endpoint\_type and custom\_image\_name. | ```list(object({ name = string type = string // "rest", "media", "onvif", "sse", "custom" // Custom Connector Fields (required when type = "custom") custom_endpoint_type = optional(string) // e.g., "Contoso.Modbus", "Acme.CustomProtocol" custom_image_name = optional(string) // e.g., "my_acr.azurecr.io/custom-connector" custom_endpoint_version = optional(string) custom_connector_metadata_ref = optional(string) // e.g., "my_acr.azurecr.io/custom-connector-metadata:1.0.0" // Runtime Configuration registry = optional(string) // Container registry for pulling connector images image_tag = optional(string) replicas = optional(number) image_pull_policy = optional(string) // Diagnostics log_level = optional(string) // MQTT Override (uses shared config if not provided) mqtt_config = optional(object({ host = string audience = string ca_configmap = string keep_alive_seconds = optional(number) max_inflight_messages = optional(number) session_expiry_seconds = optional(number) })) // Optional Advanced Fields aio_min_version = optional(string) aio_max_version = optional(string) allocation = optional(object({ policy = string // "Bucketized" bucket_size = number // 1-100 })) additional_configuration = optional(map(string)) secrets = optional(list(object({ secret_alias = string secret_key = string secret_ref = string }))) trust_settings = optional(object({ trust_list_secret_ref = string })) }))``` | n/a     |   yes    |
| custom\_location\_id | Custom location ID for the Azure IoT Operations deployment.                                                                                                                  | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | n/a     |   yes    |
| mqtt\_shared\_config | Shared MQTT connection configuration for all connectors. Individual connectors can override these settings.                                                                  | ```object({ host = string audience = string ca_configmap = string keep_alive_seconds = optional(number) max_inflight_messages = optional(number) session_expiry_seconds = optional(number) })```                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | n/a     |   yes    |

## Outputs

| Name                       | Description                                                   |
|----------------------------|---------------------------------------------------------------|
| connector\_template\_ids   | Map of connector template IDs by name.                        |
| connector\_templates       | Map of deployed connector templates by name with id and type. |
| connector\_types\_deployed | List of connector types that were deployed.                   |
<!-- END_TF_DOCS -->
